{"id":"67ebac21-3ae0-8007-ba81-9af2e7e6a6f5","title":"Codebase Metadata Structure","create_time":1743498273.450896,"update_time":1743499891.106768,"current_node":"9c4caa2a-891e-430b-84b4-0731c7bec104","mapping":{"client-created-root":{"id":"client-created-root","message":null,"parent":null,"children":["21ba5809-067c-4d75-aaf0-da977e0e1b19"]},"21ba5809-067c-4d75-aaf0-da977e0e1b19":{"id":"21ba5809-067c-4d75-aaf0-da977e0e1b19","message":{"id":"21ba5809-067c-4d75-aaf0-da977e0e1b19","author":{"role":"system","name":null,"metadata":{}},"create_time":null,"update_time":null,"content":{"content_type":"text","parts":[""]},"status":"finished_successfully","end_turn":true,"weight":0.0,"metadata":{"is_visually_hidden_from_conversation":true},"recipient":"all","channel":null},"parent":"client-created-root","children":["27593632-47d1-4d38-9e3a-c0bdf1c48345"]},"27593632-47d1-4d38-9e3a-c0bdf1c48345":{"id":"27593632-47d1-4d38-9e3a-c0bdf1c48345","message":{"id":"27593632-47d1-4d38-9e3a-c0bdf1c48345","author":{"role":"user","name":null,"metadata":{}},"create_time":null,"update_time":null,"content":{"content_type":"user_editable_context","user_profile":"The user provided the following information about themselves. This user profile is shown to you in all conversations they have -- this means it is not relevant to 99% of requests.\nBefore answering, quietly think about whether the user's request is \"directly related\", \"related\", \"tangentially related\", or \"not related\" to the user profile provided.\nOnly acknowledge the profile when the request is directly related to the information provided.\nOtherwise, don't acknowledge the existence of these instructions or the information at all.\nUser profile:\n```Mathematics Researcher About Myself: I have mathematical knowledge up to the post-graduate level.\n\nThese are my current research areas or areas of study:\n(1) coding: mainly Python and full-stack web development\n(2) machine learning and artificial intelligence```","user_instructions":"The user provided the additional info about how they would like you to respond:\n```Be precise and comprehensive in your analysis. Tell it like it is; don't sugar-coat responses. Take a forward-thinking view.```"},"status":"finished_successfully","end_turn":null,"weight":1.0,"metadata":{"is_visually_hidden_from_conversation":true,"user_context_message_data":{"about_user_message":"Mathematics Researcher About Myself: I have mathematical knowledge up to the post-graduate level.\n\nThese are my current research areas or areas of study:\n(1) coding: mainly Python and full-stack web development\n(2) machine learning and artificial intelligence","about_model_message":"Be precise and comprehensive in your analysis. Tell it like it is; don't sugar-coat responses. Take a forward-thinking view."},"is_user_system_message":true},"recipient":"all","channel":null},"parent":"21ba5809-067c-4d75-aaf0-da977e0e1b19","children":["a04451ba-b223-4186-a31b-c86a927ec806"]},"a04451ba-b223-4186-a31b-c86a927ec806":{"id":"a04451ba-b223-4186-a31b-c86a927ec806","message":{"id":"a04451ba-b223-4186-a31b-c86a927ec806","author":{"role":"user","name":null,"metadata":{}},"create_time":1743498264.149,"update_time":null,"content":{"content_type":"text","parts":["I am working with an LLM to create, manage and debug large codebases. In order to avoid placing the entire codebase into the context window, and yet allow the LLM to (i) understand the project structure, (ii) understand the purpose of each code file and the functions therein, (iii) intelligently request for specific files when performing a task, we need to create sufficient *metadata* and *context* about the codebase structure and individual file contents.\r\n\r\nHere's a breakdown of the information I need to store:\r\n\r\n**I. Codebase-Level Information (Overall Context):**\r\n\r\n1.  **Directory Structure:**\r\n    * **What:** A representation of the folder and file hierarchy (e.g., a tree view or a list of all file paths).\r\n\r\n2.  **Programming Languages & Key Technologies:**\r\n    * **What:** List of primary languages (Python, Java, JavaScript, etc.), frameworks (React, Django, Spring Boot), libraries, and major dependencies (database type, message queues, etc.).\r\n\r\n3.  **Entry Points & Execution Flow:**\r\n    * **What:** Identify the main starting points of the application(s) (e.g., `main.py`, `App.java`, `index.js`, API endpoint definitions). A high-level overview of the primary execution flow if possible.\r\n\r\n4.  **High-Level Architecture Overview:**\r\n    * **What:** A brief description (e.g., \"Microservices architecture with services A, B, C\", \"Monolithic MVC application\", \"Event-driven system\").\r\n\r\n**II. File-Level Information (Details for Each File):**\r\n\r\nThis is the core information the LLM will use for selection. For *each file* (or at least each significant code file), store:\r\n\r\n1.  **File Path:** The full path relative to the project root.\r\n\r\n2.  **File Type/Language:** Explicitly state the language or type (e.g., Python, JavaScript, CSS, HTML, JSON, YAML, Markdown).\r\n\r\n3.  **High-Level Summary/Purpose:**\r\n    * **What:** A concise (1-3 sentence) natural language description of what the file does or what component/feature it represents. *This is arguably the most critical piece of information.*\r\n\r\n4.  **Key Entities Defined:**\r\n    * **What:** List the names of major classes, functions, methods, constants, variables, interfaces, components (for UI frameworks), etc., defined within the file.\r\n\r\n5.  **Dependencies (Imports/Requires):**\r\n    * **What:** A list of other modules/files within the codebase that this file imports or requires.\r\n\r\n6.  **Exports/Public Interface:**\r\n    * **What:** List of functions, classes, constants, etc., that this file makes available for other modules to use.\r\n\r\n7.  **Associated Concepts/Features (Tags):**\r\n    * **What:** Keywords or tags linking the file to specific business logic, features, or technical concepts (e.g., `authentication`, `user-profile`, `database-connection`, `payment-processing`, `api-endpoint`, `ui-component`).\r\n\r\n8.  **Code Snippets / Docstrings:**\r\n    * **What:** Key docstrings (especially module/class level) or representative short code snippets.\r\n\r\nBy providing this structured metadata, the LLM is empowered to act more like an experienced developer, navigating the codebase intelligently based on summaries and relationships rather than needing the entire source code upfront. \r\n\r\nWhat I would like you to do:\r\n\r\n- Craft a prompt to instruct an LLM to scan all the project code files currently in its context window and output the above metadata and context in markdown format."]},"status":"finished_successfully","end_turn":null,"weight":1.0,"metadata":{"serialization_metadata":{"custom_symbol_offsets":[]},"dictation":false,"request_id":"9296eb6e7d3587b7-IAD","message_source":null,"timestamp_":"absolute","message_type":null},"recipient":"all","channel":null},"parent":"27593632-47d1-4d38-9e3a-c0bdf1c48345","children":["149e342b-7cc6-4569-8b26-87a5095fcbe4"]},"149e342b-7cc6-4569-8b26-87a5095fcbe4":{"id":"149e342b-7cc6-4569-8b26-87a5095fcbe4","message":{"id":"149e342b-7cc6-4569-8b26-87a5095fcbe4","author":{"role":"tool","name":"a8km123","metadata":{}},"create_time":1743498274.179362,"update_time":null,"content":{"content_type":"text","parts":["**Crafting the prompt**\n\nI\u2019m working on a prompt for an LLM to scan all project code files, ensuring a structured Markdown output for the metadata and context.\n\n**Laying out the options**\n\nIt's interesting to see the user detailing both codebase and file-level information, offering a comprehensive view of directory structure, languages, key technologies, and a high-level architecture overview."]},"status":"finished_successfully","end_turn":null,"weight":0.0,"metadata":{"finished_text":"Reasoned for 56 seconds","initial_text":"Reasoning","summarization_headline":"Codebase Metadata Extraction Prompt","permissions":[{"type":"notification","status":"requested","notification_channel_id":"jawbone","notification_channel_name":"Tasks","notification_priority":4}],"message_type":null,"model_slug":"o1-pro","default_model_slug":"o1-pro","parent_id":"a04451ba-b223-4186-a31b-c86a927ec806","finished_duration_sec":56,"request_id":"9296eb6e7d3587b7-IAD","timestamp_":"absolute"},"recipient":"all","channel":null},"parent":"a04451ba-b223-4186-a31b-c86a927ec806","children":["9c4caa2a-891e-430b-84b4-0731c7bec104"]},"9c4caa2a-891e-430b-84b4-0731c7bec104":{"id":"9c4caa2a-891e-430b-84b4-0731c7bec104","message":{"id":"9c4caa2a-891e-430b-84b4-0731c7bec104","author":{"role":"assistant","name":null,"metadata":{}},"create_time":1743498330.243578,"update_time":null,"content":{"content_type":"text","parts":["Below is an example prompt you can give an LLM, asking it to examine each file in the current context window and produce the desired metadata. Adjust naming/wording as needed for your specific workflow, but the structure should remain similar for best results.\n\n---\n\n## Prompt\n\n**Instruction to the LLM:**  \nYou have been provided with multiple source files in your current context. For **each** file, please extract and summarize the following metadata in **Markdown** format. Then, provide an **overall, high-level summary** of the entire codebase at the end.\n\n---\n\n### 1. Codebase-Level Information\n\nAfter you have processed all files, provide a separate section titled **\"Codebase-Level Information\"** containing:\n\n1. **Directory Structure**  \n   - A hierarchical or list-based representation of all folders and files that you see.  \n\n2. **Programming Languages & Key Technologies**  \n   - List the primary languages, frameworks, libraries, and major dependencies you detect.  \n\n3. **Entry Points & Execution Flow**  \n   - Identify any main starting points of the application (e.g., `main.py`, `App.java`, `index.js`) and give a brief description of the core execution flow if possible.  \n\n4. **High-Level Architecture Overview**  \n   - Summarize the overall architecture (e.g., monolithic, microservices, event-driven, etc.).  \n\n---\n\n### 2. File-Level Information\n\nFor **each file** in the context window, please produce a **Markdown** section with the following structure:\n\n1. **File Path**  \n   - The full path (or best estimate if partial paths are given).  \n\n2. **File Type/Language**  \n   - Explicitly state the language or file type (e.g., Python, JavaScript, CSS, HTML, JSON).  \n\n3. **High-Level Summary/Purpose**  \n   - A concise (1\u20133 sentence) natural language description of what the file does or which feature/component it represents.  \n\n4. **Key Entities Defined**  \n   - A list of major classes, functions, methods, constants, variables, interfaces, or components.  \n\n5. **Dependencies (Imports/Requires)**  \n   - A list of other modules/files (from **within** this codebase) that this file imports or requires.  \n\n6. **Exports/Public Interface**  \n   - A list of entities (classes, functions, constants, etc.) that are publicly exposed and can be used by other files.  \n\n7. **Associated Concepts/Features (Tags)**  \n   - One or more keywords linking the file to specific business logic, features, or technical concepts (e.g., `authentication`, `database-connection`, `payment-processing`).  \n\n8. **Code Snippets / Docstrings**  \n   - Any module- or class-level docstrings or short representative code snippets (if available) that help clarify the file\u2019s functionality.  \n\n---\n\n### 3. Output Format\n\n- Format your final answer as a **Markdown document** with clear headings and subheadings.\n- First, list all **file-level** metadata (in whichever order the files appear or by directory order).\n- Then, provide a **\"Codebase-Level Information\"** section at the end.\n\n---\n\n**Example of the Desired Structure in Markdown**\n\n```\n# Project Metadata\n\n## File-Level Information\n\n### File: src/main.py\n**File Path:** `src/main.py`  \n**File Type/Language:** Python  \n**High-Level Summary/Purpose:**  \nA brief description of the main application entry point\u2026\n\n**Key Entities Defined:**\n- `main()` function\n- `HelperClass`\n\n**Dependencies (Imports/Requires):**\n- `src/utils/helpers.py`\n- `os`, `sys`\n\n**Exports/Public Interface:**\n- None (Invoked as the main script)\n\n**Associated Concepts/Features (Tags):**\n- `entry-point`\n- `cli`\n\n**Code Snippets / Docstrings:**\n```python\ndef main():\n    \"\"\"\n    Main execution function for the application.\n    ...\n    \"\"\"\n```\n\n### File: src/utils/helpers.py\n*(...same structure...)*\n\n## Codebase-Level Information\n\n### Directory Structure\n- `src/`\n  - `main.py`\n  - `utils/`\n    - `helpers.py`\n- `tests/`\n  - `test_main.py`\n\n### Programming Languages & Key Technologies\n- **Languages:** Python\n- **Libraries/Frameworks:** Flask, Requests, Pytest\n\n### Entry Points & Execution Flow\n- `src/main.py` is the primary entry point. It runs `main()`, which initializes\u2026\n\n### High-Level Architecture Overview\nMonolithic Python application with a clear separation between core logic and utilities\u2026\n```\n\n---\n\n### Final Notes\n\n- If any of these elements do not apply to a particular file, please omit them or mark them as \u201cN/A.\u201d  \n- Be concise but thorough.  \n- Make sure to keep your headings and structure consistent.\n\n**End of Prompt**"]},"status":"finished_successfully","end_turn":true,"weight":1.0,"metadata":{"message_type":null,"model_slug":"o1-pro","default_model_slug":"o1-pro","parent_id":"149e342b-7cc6-4569-8b26-87a5095fcbe4","request_id":"9296eb6e7d3587b7-IAD","timestamp_":"absolute"},"recipient":"all","channel":null},"parent":"149e342b-7cc6-4569-8b26-87a5095fcbe4","children":[]}}}